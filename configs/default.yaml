# Urban Structure Analysis System - 統合設定ファイル
# ============================================================

# ===== Phase 1: Acquisition & Space =====
canvas:
  half_size_m: 1000        # 中心から±1000m = 2km四方
  resolution_m: 1.0        # 1px = 1m

road_width_fallback:
  motorway: 20
  trunk: 15
  primary: 12
  secondary: 10
  tertiary: 8
  residential: 6
  service: 4
  default: 5

# ===== Phase 3: Analysis Engine =====
analysis:
  # 共通スケールレンジ（全指標で統一）
  r_min: 2
  r_max: 512
  r_steps: 20              # log2スケールで生成

  mfa:
    q_min: -10
    q_max: 10
    q_steps: 41
    grid_shift_count: 16   # グリッドシフト平均化

  lacunarity:
    method: "integral_image"  # or "gliding_box"
    full_scan: true           # 全画素探索

  percolation:
    d_min: 1
    d_max: 100
    d_steps: 50

# ===== Execution =====
execution:
  n_jobs: -1               # joblib並列数 (-1 = 全コア)
  cache_integral: true     # 積分画像をキャッシュ
  verbose: true

# ===== Clustering =====
clustering:
  # 前処理設定
  preprocessing:
    normalization_method: "minmax"  # "minmax", "standard", "robust" (比較結果で最適: minmax)
    dimensionality_reduction: "pca"  # "pca", "umap", "tsne", null
    n_components: null              # null = 自動選択 (PCA: 95%分散, その他: 2)
    random_state: 42
  
  # クラスタリング設定
  method: "kmeans"         # "kmeans", "dbscan", "hierarchical"
  n_clusters: null         # null = エルボー法で自動最適化
  eps: 0.5                 # DBSCAN用 (最適化時は無視)
  min_samples: 3          # DBSCAN用 (最適化時は無視)
  linkage: "ward"         # Hierarchical用 ("ward", "complete", "average")
  
  # 最適化設定
  optimization:
    # エルボー法によるクラスタ数最適化
    use_elbow_method: true           # true = エルボー法を使用, false = n_clustersを直接指定
    min_clusters: 2                  # 最小クラスタ数
    max_clusters: 10                 # 最大クラスタ数
    elbow_metric: "silhouette"       # "inertia", "silhouette", "davies_bouldin"
    
    # DBSCANパラメータ探索範囲
    dbscan_eps_range: [0.1, 0.3, 0.5, 0.7, 1.0]  # eps探索範囲
    dbscan_min_samples_range: [2, 3, 4, 5]      # min_samples探索範囲
    
    # 複数クラスタ数での比較
    compare_cluster_numbers: true    # true = 複数のクラスタ数で比較
    cluster_numbers_to_compare: null  # null = min_clustersからmax_clustersまで全て
    
    # 結果の解釈
    interpret_results: true          # true = クラスタごとの特徴量統計を計算

